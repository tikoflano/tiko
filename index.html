<!DOCTYPE html>
<html>
    <head>
        <base href="/tiko/" />
        <title>Juego</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <link rel="stylesheet" type="text/css" href="semantic/semantic.min.css"/>
        <link rel="stylesheet" type="text/css" href="css/style.css"/>
        <link rel="stylesheet" type="text/css" href="css/card.css"/>
        <link rel="stylesheet" type="text/css" href="css/die.css"/>
        <link rel="stylesheet" type="text/css" href="css/dice.css"/>
        <link rel="stylesheet" type="text/css" href="css/board.css"/>
        <link rel="stylesheet" type="text/css" href="css/player.css"/>
        <link rel="stylesheet" type="text/css" href="css/messages.css"/>
        <link rel="stylesheet" type="text/css" href="css/figure.css"/>
        
        <script src="jquery/jquery-3.2.1.min.js"></script>
        <script src="semantic/semantic.min.js"></script>
        <script src="angular-1.6.4/angular.min.js"></script>
        <script src="angular-1.6.4/angular-messages.min.js"></script>
        <script src="lodash/lodash.min.js"></script>
        
        <script src="game/game.js"></script>
        <script src="game/controllers.js"></script>
        <script src="game/factories/card.js"></script>
        <script src="game/factories/board.js"></script>
        <script src="game/factories/player.js"></script>
        <script src="game/factories/deck.js"></script>
        <script src="game/directives.js"></script>
    </head>
    <body ng-app="game" ng-controller="GameController as ctrl" ng-init="ctrl.init()" ng-keypress="$event.key == ' ' && ctrl.playPhase()">
        <div class="ui container">
            <div class="ui grid">
                <div id="actions" class="row">
                    <div class="column">
                        <input type="color" ng-model="new_player_color" ng-disabled="ctrl.players.length >= 2">
                        <div class="ui action input">
                            <input type="text" ng-model="new_player_name" placeholder="Nombre" ng-disabled="ctrl.players.length >= 2">
                            <button class="ui blue button" ng-click="ctrl.addPlayer(new_player_name, new_player_color);new_player_name = ''" ng-disabled="ctrl.players.length >= 2">Agregar jugador</button>
                        </div>
                        <input type="number" ng-model="ctrl.number" ng-if="ctrl.debug">
                    </div>
                </div>
                <div id="messages" class="row">
                    <div class="ui icon message">
                        <i class="info circle icon"></i>
                        <div class="content">
                            <div class="header">Fase actual</div>
                            <p>{{ctrl.phase.text}}</p>
                        </div>
                    </div>
                    <div class="ui icon message" ng-if="ctrl.message" ng-class="ctrl.message.type">
                        <i class="warning circle icon"></i>
                        <div class="content">
                            <div class="header">{{ctrl.message.header}}</div>
                            <p>{{ctrl.message.message}}</p>
                        </div>
                    </div>
                </div>
                <div id="players" class="equal width row">
                    <div class="center aligned column" ng-repeat="player in ctrl.players" >
                        <div class="ui compact segment player" ng-class="{active: player.active}">
                            <span class="name" ng-click="player.showBoard()" ng-style="{background: player.color}">{{player.name}}</span>
                            <div class="player-cards">
                                <span class="player-card" ng-repeat="player_card in player.player_cards" ng-style="{'background-color': player.color}"></span>
                                <span ng-hide="player.player_cards.length">-</span>
                            </div>
                            <div class="hand">
                                <div class="ui horizontal segments" >
                                    <div class="ui segment" ng-repeat="number_card in player.hand" >
                                        <card card="number_card" ng-click="number_card.active = player.active && !number_card.active" ></card>
                                    </div>
                                </div>
                            </div>
                            <player-board player="player"></player-board>
                        </div>
                    </div>
                </div>
                <div id="dice" class="centered row">
                    <div class="ui horizontal segments">
                        <span class="ui die compact segment" ng-repeat="die in ctrl.dice" ng-class="[die.color, {active: die.active}, die.number ? 'die-'+die.number : 'die-0']" ng-click="die.active = !die.active"></span>
                    </div>
                </div>
                <div class="board centered row">
                    <div class="ui compact segments">
                        <div class="ui horizontal segments" ng-repeat="row in ctrl.board.rows">
                            <div class="ui segment" ng-repeat="number_card in row" >
                                <card ng-click="number_card.active = !number_card.active" card="number_card"></card>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
